<view class="container">
  <!-- è¿æ¥çŠ¶æ€æ˜¾ç¤º -->
  <view class="status-card">
    <view class="status">
      è¿æ¥çŠ¶æ€ï¼š{{connected ? 'å·²è¿æ¥ ' + deviceName : 'æœªè¿æ¥'}}
    </view>
  </view>
  
  <!-- å›¾è¡¨åŒºåŸŸ -->
  <view class="chart-container">
    <canvas
      canvas-id="eegChart"
      style="width:100%; height:200px;"
      disable-scroll="true"
    ></canvas>
  </view>

  <!-- å‚æ•°æ˜¾ç¤º -->
  <view class="parameter">
    <view>âš¡ æ ·æœ¬ç†µï¼š{{powerRatio !== null ? powerRatio : 'æœªè®¡ç®—'}}</view>
  </view>

  <view class="game-container" wx:if="{{experimentStarted && (currentPhase === 'æ²»ç–—é˜¶æ®µ' || currentPhase === 'åŸºå‡†é˜¶æ®µ')}}">
  <!-- å½“å‰åœºæ™¯èƒŒæ™¯ -->
  <image 
    src="{{scenes[currentScene].image}}" 
    class="scene-background" 
    style="opacity: {{1 - sceneTransitionProgress}}"
    mode="aspectFill"
  />
  
  <!-- ä¸‹ä¸€ä¸ªåœºæ™¯èƒŒæ™¯ï¼ˆè¿‡æ¸¡ç”¨ï¼‰ -->
  <image 
    src="{{scenes[nextScene] ? scenes[nextScene].image : ''}}" 
    class="scene-background" 
    style="opacity: {{sceneTransitionProgress}}"
    mode="aspectFill"
    wx:if="{{nextScene}}"
  />
    
  <view class="bird-container" style="top: {{birdY}}%">

  <!-- å°é¸Ÿå›¾ç‰‡ -->
  <image 
    src="/images/bird.gif" 
    class="bird-image"
    mode="widthFix"
  />
</view>
    
    <!-- æ¸¸æˆçŠ¶æ€ -->
    <view class="game-stats">
      <view class="stat-item">
        <view class="icon-time"></view>
        <text>{{remainingTime}}s</text>
      </view>
      <!-- <view class="stat-item">
        <view class="icon-attention"></view>
        <text>{{currentAttention}}%</text>
      </view> -->
      <view class="stat-item">
        <view class="icon-scene"></view>
        <text>Lv.{{scenes[currentScene].level}}</text>
      </view>
    </view>
    
    <!-- æ¸¸æˆç»“æŸç•Œé¢ -->
    <view class="game-over" wx:if="{{gameOver}}">
      <view class="game-over-title">è®­ç»ƒå®Œæˆ</view>
      <view class="game-over-level">æœ€ç»ˆç­‰çº§: {{scenes[currentScene].level}}</view>
      <button class="restart-btn" bindtap="restartExperiment">é‡æ–°å¼€å§‹</button>
    </view>
  </view>
  
  
  <!-- å®éªŒä¿¡æ¯ -->
  <view class="experiment-info" wx:if="{{experimentStarted}}">
    <view wx:if="{{currentPhase === 'å‡†å¤‡é˜¶æ®µ'}}">
      <text>ğŸ¯ å‡†å¤‡ä¸­ï¼š{{remainingTime}}ç§’åå¼€å§‹åŸºå‡†æµ‹è¯•</text>
    </view>
    <view>ğŸ“Š å®éªŒé˜¶æ®µï¼š{{currentPhase}}</view>
    <view>â° å‰©ä½™æ—¶é—´ï¼š{{remainingTime}}ç§’</view>
    <view>ğŸ“ åŸºå‡†å€¼ï¼š{{baselineValue !== null ? baselineValue : 'è®¡ç®—ä¸­'}}</view>
    <view>ğŸ§  å½“å‰æ³¨æ„åŠ›ï¼š{{currentAttention !== null ? currentAttention : 'è®¡ç®—ä¸­'}}</view>
  </view>
  
  <!-- æ§åˆ¶æŒ‰é’®åŒºåŸŸ -->
  <view class="control-panel">
    <!-- æ•°æ®å‘é€åŒºåŸŸ -->
    <view class="input-section">
      <input
        class="data-input"
        placeholder="è¯·è¾“å…¥åå…­è¿›åˆ¶æ•°æ®ï¼ˆå¦‚ï¼šA1B2C3ï¼‰"
        bindinput="handleInput"
        value="{{inputData}}"
      />
      <button class="control-btn send-btn" bindtap="sendData">
        ğŸ“¤ å‘é€æ•°æ®
      </button>
    </view>

    <!-- ä¸»è¦æ“ä½œæŒ‰é’® -->
    <view class="main-actions">
      <button class="control-btn primary" bindtap="navigateToScan">
        {{connected ? 'ğŸ”„ é‡æ–°è¿æ¥' : 'ğŸ” æœç´¢è®¾å¤‡'}}
      </button>

      <button
        class="control-btn success"
        bindtap="startExperiment"
        wx:if="{{!experimentStarted && connected}}"
      >
        ğŸš€ å¼€å§‹å®éªŒ
      </button>

      <button
        class="control-btn danger"
        bindtap="stopExperiment"
        wx:if="{{experimentStarted}}"
      >
        â¹ï¸ ç»“æŸå®éªŒ
      </button>

      <button class="control-btn secondary" bindtap="navigateToHistory">
        ğŸ“Š å†å²è®°å½•
      </button>
    </view>
  </view>
</view>