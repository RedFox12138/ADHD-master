<view class="container">
  <!-- 连接状态显示 -->
  <view class="status">
    连接状态：{{connected ? '已连接 ' + deviceName : '未连接'}}
  </view>
  
  <!-- 图表区域 -->
  <canvas 
    canvas-id="eegChart" 
    style="width:100%; height:200px;"
    disable-scroll="true"
  ></canvas>
  
  <!-- 参数显示 -->
  <view class="parameter">
    <view>Theta/Beta 功率比：{{powerRatio !== null ? powerRatio : '未计算'}}</view>
    <view>Delta 累计功率：{{DeltaPower !== null ? DeltaPower : '未计算'}}</view>
  </view>

  <view class="game-container" wx:if="{{experimentStarted && (currentPhase === '治疗阶段' || currentPhase === '基准阶段')}}">
  <!-- 当前场景背景 -->
  <image 
    src="{{scenes[currentScene].image}}" 
    class="scene-background" 
    style="opacity: {{1 - sceneTransitionProgress}}"
    mode="aspectFill"
  />
  
  <!-- 下一个场景背景（过渡用） -->
  <image 
    src="{{scenes[nextScene] ? scenes[nextScene].image : ''}}" 
    class="scene-background" 
    style="opacity: {{sceneTransitionProgress}}"
    mode="aspectFill"
    wx:if="{{nextScene}}"
  />
    
  <view class="bird-container" style="top: {{birdY}}%">

  <!-- 小鸟图片 -->
  <image 
    src="/images/bird.gif" 
    class="bird-image"
    mode="widthFix"
  />
</view>
    
    <!-- 游戏状态 -->
    <view class="game-stats">
      <view class="stat-item">
        <view class="icon-time"></view>
        <text>{{remainingTime}}s</text>
      </view>
      <!-- <view class="stat-item">
        <view class="icon-attention"></view>
        <text>{{currentAttention}}%</text>
      </view> -->
      <view class="stat-item">
        <view class="icon-scene"></view>
        <text>Lv.{{scenes[currentScene].level}}</text>
      </view>
    </view>
    
    <!-- 游戏结束界面 -->
    <view class="game-over" wx:if="{{gameOver}}">
      <view class="game-over-title">训练完成</view>
      <view class="game-over-level">最终等级: {{scenes[currentScene].level}}</view>
      <button class="restart-btn" bindtap="restartExperiment">重新开始</button>
    </view>
  </view>
  
  
  <!-- 实验信息 -->
  <view class="experiment-info" wx:if="{{experimentStarted}}">
    <view wx:if="{{currentPhase === '准备阶段'}}">
      <text>准备中：{{remainingTime}}秒后开始基准测试</text>
    </view>
    <view>实验阶段：{{currentPhase}}</view>
    <view>剩余时间：{{remainingTime}}秒</view>
    <view>基准值：{{baselineValue !== null ? baselineValue : '计算中'}}</view>
    <view>当前注意力：{{currentAttention !== null ? currentAttention : '计算中'}}</view>
  </view>
  
  
  <!-- 控制按钮区域 -->
  <view class="control-area">
    <input 
      class="input" 
      placeholder="请输入十六进制数据（如：A1B2C3）" 
      bindinput="handleInput" 
      value="{{inputData}}" 
    />
    <button class="btn" bindtap="sendData">发送数据</button>
    <button class="btn" bindtap="navigateToScan">
      {{connected ? '重新连接' : '搜索设备'}}
    </button>
    <button 
      class="btn" 
      bindtap="startExperiment" 
      wx:if="{{!experimentStarted && connected}}"
    >开始实验</button>
    <button 
      class="btn" 
      bindtap="stopExperiment" 
      wx:if="{{experimentStarted}}"
    >结束实验</button>
    <view class="history-btn" bindtap="navigateToHistory">
      <button class="btn history-btn" catchtap="navigateToHistory">历史记录</button>
  </view>
  </view>
  

 
</view>