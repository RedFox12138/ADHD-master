<view class="container">
  <view class="status">
    连接状态：{{connected ? '已连接' + deviceName : '未连接'}}
  </view>

  <view class="parameter">
    Theta/Beta 功率比：{{powerRatio !== null ? powerRatio : '未计算'}}
  </view>
  
  <view class="experiment-info" wx:if="{{experimentStarted}}">
    <view>实验阶段：{{currentPhase}}</view>
    <view>剩余时间：{{remainingTime}}秒</view>
    <view>基准值：{{baselineValue !== null ? baselineValue : '计算中'}}</view>
    <view>当前注意力：{{currentAttention !== null ? currentAttention : '计算中'}}</view>
  </view>

  <!-- <canvas 
    class="canvas" 
    canvas-id="EEG" 
    binderror="canvasIdErrorCallback" 
    disable-scroll="true" 
  /> -->
  
  <!-- 游戏区域 -->
  <view class="game-container" wx:if="{{experimentStarted && currentPhase === '治疗阶段'}}">
    <!-- 场景背景 -->
    <image 
      src="{{scenes[currentScene].image}}" 
      class="scene-background {{sceneChanged ? 'scene-transition' : ''}}"
      mode="aspectFill"
    />
    
    <!-- 纯CSS绘制的小鸟 -->
    <view class="bird" style="top: {{birdY}}%">
      <view class="bird-body"></view>
      <view class="bird-wing"></view>
      <view class="bird-beak"></view>
    </view>
    
    <!-- 纯CSS绘制的状态指示器 -->
    <view class="game-stats">
      <view class="stat-item">
        <view class="icon-time"></view>
        <text>{{remainingTime}}s</text>
      </view>
      <view class="stat-item">
        <view class="icon-attention"></view>
        <text>{{currentAttention}}%</text>
      </view>
      <view class="stat-item">
        <view class="icon-scene"></view>
        <text>Lv.{{scenes[currentScene].level}}</text>
      </view>
    </view>
    
    <!-- 游戏结束 -->
    <view class="game-over" wx:if="{{gameOver}}">
      <view class="game-over-title">训练完成</view>
      <view class="game-over-level">最终等级: {{scenes[currentScene].level}}</view>
      <button class="restart-btn" bindtap="restartExperiment">重新开始</button>
    </view>
  </view>

  <!-- 控制按钮区域 -->
  <view class="control-area">
    <input 
      class="input" 
      placeholder="请输入十六进制数据（如：A1B2C3）" 
      bindinput="handleInput" 
      value="{{inputData}}" 
    />
    <button class="btn" bindtap="sendData">发送数据</button>
    <button class="btn" bindtap="startExperiment" wx:if="{{!experimentStarted}}">开始实验</button>
    <button class="btn" bindtap="navigateToScan">
      {{connected ? '重新连接' : '搜索设备'}}
    </button>
  </view>
</view>