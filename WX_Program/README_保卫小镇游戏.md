# 保卫小镇 - 脑反馈注意力治疗游戏

## 游戏概述

保卫小镇是一款基于脑电反馈的注意力训练游戏，取代了原有的小鸟飞行游戏。游戏通过实时监测用户的脑电特征，当注意力集中时获得经验值，通过升级来增强防御能力，保护小镇免受怪物入侵。

## 游戏流程

### 1. 基线收集阶段 (30秒)
- 显示"请保持放松，小镇正在生成"
- 炫酷进度条显示收集进度
- 收集用户放松状态下的脑电基线数据
- 计算BaseValue作为后续判断的基准

### 2. 游戏阶段 (180秒)
- 显示"请集中注意力，保卫小镇！"提示3秒
- 开始塔防游戏循环
- 实时监测脑电特征，与基线对比获得经验值
- 通过升级增强防御能力

## 游戏机制

### 小镇系统
- 初始血量：100 HP
- 位置：地图中心
- 被怪物攻击时扣血，血量为0游戏失败

### 炮台系统
- 初始数量：1个炮台
- 最大数量：6个炮台  
- 攻击间隔：2秒
- 攻击范围：150rpx
- 自动攻击距离小镇最近的怪物

### 怪物系统
- 生成位置：地图四周边缘随机位置
- 移动目标：直线向小镇移动
- 攻击距离：接近小镇50rpx范围内开始攻击
- 攻击间隔：4秒造成2点伤害
- 血量随波数递增：1,1,2,2,3,3,4,4...

### 经验值与升级系统
- 获得条件：当前脑电特征 > BaseValue时，每0.5秒获得1经验值
- 升级效果：
  - 1-6级：每级增加1个炮台（最多6个）
  - 7级：炮台可同时攻击2个目标
  - 8-9级：炮台攻击力+1
  - 10级：炮台可同时攻击3个目标  
  - 11级：炮台攻击力再+1

### 难度递增系统
- 每30秒进入下一波
- 怪物血量递增
- 怪物生成频率加快
- 怪物移动速度提升

## 数值平衡

### 经验值阈值
- 2级: 10经验
- 3级: 25经验  
- 4级: 45经验
- 5级: 70经验
- 6级: 100经验
- 7级: 140经验
- 8级: 190经验
- 9级: 250经验
- 10级: 320经验
- 11级: 400经验

### 时间平衡
- 游戏总时长：180秒
- 难度递增：每30秒一波，共6波
- 经验获得：理论最大值每秒2经验（0.5秒检查间隔）
- 升级速度：保证在游戏时间内可以达到较高等级

## 用户界面

### 游戏状态面板
- 时间：剩余游戏时间
- 等级：当前玩家等级
- 经验：当前经验值/下级所需经验值
- 炮台：当前炮台数量
- 经验值进度条

### 血条系统  
- 小镇血条：显示HP/最大HP
- 怪物血条：怪物HP>1时显示

### 特效系统
- 子弹：金色发光效果
- 爆炸：渐现渐隐动画
- 怪物：轻微缩放动画
- 升级提示：Toast提示

## 技术特性

### 性能优化
- 游戏循环：50ms间隔更新
- 对象管理：及时清理死亡怪物、消失子弹、结束爆炸
- 内存控制：避免对象累积造成内存泄漏

### 响应式设计
- 支持不同屏幕尺寸
- rpx单位适配
- 触摸友好的界面设计

### 数据流
- 脑电数据 → 服务器处理 → TBR特征值 → 与基线对比 → 经验值增长 → 游戏升级

## 游戏文件结构

```
WX_Program/
├── pages/index/
│   ├── index.js     # 游戏主逻辑
│   ├── index.wxml   # 游戏界面结构  
│   └── index.wxss   # 游戏样式
├── utils/
│   └── gameConfig.js # 游戏数值配置
└── images/
    ├── town.svg     # 小镇图片
    ├── turret.svg   # 炮台图片
    ├── monster.svg  # 怪物图片
    ├── bullet.svg   # 子弹图片
    └── explosion.svg # 爆炸特效
```

## 使用说明

1. 确保设备已连接脑电采集设备
2. 点击"开始实验"
3. 基线阶段保持放松，让系统收集基准数据
4. 游戏阶段集中注意力，通过脑电反馈获得经验值
5. 升级炮台防御小镇，坚持到游戏结束

## 注意事项

- 需要稳定的脑电信号采集
- 建议在安静环境下进行训练
- 游戏难度会随时间递增，需要持续保持注意力
- 可通过调整gameConfig.js中的数值来平衡难度